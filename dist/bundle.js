(()=>{"use strict";var t;!function(t){t.RADIANT="Radiant",t.AURUM="Aurum",t.SOLARI="Solari"}(t||(t={}));class i{constructor(t,i){this.x=t,this.y=i}distanceTo(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}normalize(){const t=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return 0===t?new i(0,0):new i(this.x/t,this.y/t)}}class e{constructor(t,i,e=1){this.origin=t,this.direction=i,this.intensity=e}intersects(t,i){return!0}}class s{constructor(t,i){this.position=t,this.owner=i,this.health=100,this.efficiency=1}hasLineOfSightToLight(t){return t.length>0}hasLineOfSightToForge(t,i){return!0}generateSolarium(t){return 10*this.efficiency*t}}class n{constructor(t,i){this.position=t,this.owner=i,this.health=1e3,this.isReceivingLight=!1,this.unitQueue=[]}canProduceUnits(){return this.isReceivingLight&&this.health>0}produceUnit(t,i,e){return!(!this.canProduceUnits()||e<i||(this.unitQueue.push(t),0))}updateLightStatus(t,i){this.isReceivingLight=!1;for(const e of t)if(e.hasLineOfSightToLight(i)&&e.hasLineOfSightToForge(this,[])){this.isReceivingLight=!0;break}}}class o{constructor(t,i=1,e=100){this.position=t,this.intensity=i,this.radius=e}emitLight(t){return new e(this.position,t,this.intensity)}}class h{constructor(t,i){this.name=t,this.faction=i,this.solarium=100,this.stellarForge=null,this.solarMirrors=[],this.units=[]}isDefeated(){return null===this.stellarForge||this.stellarForge.health<=0}addSolarium(t){this.solarium+=t}spendSolarium(t){return this.solarium>=t&&(this.solarium-=t,!0)}}class r{constructor(){this.players=[],this.suns=[],this.gameTime=0,this.isRunning=!1}update(t){this.gameTime+=t;for(const i of this.players)if(!i.isDefeated()){i.stellarForge&&i.stellarForge.updateLightStatus(i.solarMirrors,this.suns);for(const e of i.solarMirrors)if(e.hasLineOfSightToLight(this.suns)&&i.stellarForge&&e.hasLineOfSightToForge(i.stellarForge,[])){const s=e.generateSolarium(t);i.addSolarium(s)}}}checkVictoryConditions(){const t=this.players.filter(t=>!t.isDefeated());return 1===t.length?t[0]:null}initializePlayer(t,i,e){t.stellarForge=new n(i,t);for(const i of e){const e=new s(i,t);t.solarMirrors.push(e)}}}class a{constructor(t){this.camera=new i(0,0),this.zoom=1,this.canvas=t;const e=t.getContext("2d");if(!e)throw new Error("Could not get 2D context from canvas");this.ctx=e,this.resizeCanvas(),window.addEventListener("resize",()=>this.resizeCanvas())}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}worldToScreen(t){const e=this.canvas.width/2,s=this.canvas.height/2;return new i(e+(t.x-this.camera.x)*this.zoom,s+(t.y-this.camera.y)*this.zoom)}getFactionColor(i){switch(i){case t.RADIANT:return"#FFD700";case t.AURUM:return"#DAA520";case t.SOLARI:return"#FF8C00";default:return"#FFFFFF"}}drawSun(t){const i=this.worldToScreen(t.position),e=t.radius*this.zoom,s=this.ctx.createRadialGradient(i.x,i.y,0,i.x,i.y,e);s.addColorStop(0,"rgba(255, 255, 150, 1)"),s.addColorStop(.5,"rgba(255, 200, 50, 0.5)"),s.addColorStop(1,"rgba(255, 150, 0, 0)"),this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.arc(i.x,i.y,e,0,2*Math.PI),this.ctx.fill(),this.ctx.fillStyle="#FFFF00",this.ctx.beginPath(),this.ctx.arc(i.x,i.y,.6*e,0,2*Math.PI),this.ctx.fill()}drawStellarForge(t,i){const e=this.worldToScreen(t.position),s=40*this.zoom;this.ctx.fillStyle=i,this.ctx.strokeStyle=t.isReceivingLight?"#00FF00":"#FF0000",this.ctx.lineWidth=3,this.ctx.beginPath();for(let t=0;t<6;t++){const i=Math.PI/3*t,n=e.x+s*Math.cos(i),o=e.y+s*Math.sin(i);0===t?this.ctx.moveTo(n,o):this.ctx.lineTo(n,o)}this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke();const n=2*s,o=e.x-n/2,h=e.y-s-15;this.ctx.fillStyle="#333",this.ctx.fillRect(o,h,n,6);const r=t.health/1e3;this.ctx.fillStyle=r>.5?"#00FF00":r>.25?"#FFFF00":"#FF0000",this.ctx.fillRect(o,h,n*r,6)}drawSolarMirror(t,i){const e=this.worldToScreen(t.position),s=20*this.zoom;this.ctx.fillStyle=i,this.ctx.strokeStyle="#FFFFFF",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y-s),this.ctx.lineTo(e.x+s,e.y),this.ctx.lineTo(e.x,e.y+s),this.ctx.lineTo(e.x-s,e.y),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke(),t.efficiency<1&&(this.ctx.fillStyle="rgba(255, 0, 0, 0.5)",this.ctx.beginPath(),this.ctx.arc(e.x,e.y,.5*s,0,2*Math.PI),this.ctx.fill())}drawConnections(t,i){if(!t.stellarForge)return;const e=this.worldToScreen(t.stellarForge.position);for(const s of t.solarMirrors)if(s.hasLineOfSightToLight(i)&&s.hasLineOfSightToForge(t.stellarForge,[])){const t=this.worldToScreen(s.position);this.ctx.strokeStyle="rgba(255, 255, 0, 0.3)",this.ctx.lineWidth=2,this.ctx.setLineDash([5,5]),this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.stroke(),this.ctx.setLineDash([])}}drawUI(t){this.ctx.fillStyle="rgba(0, 0, 0, 0.7)",this.ctx.fillRect(10,10,300,150),this.ctx.fillStyle="#FFFFFF",this.ctx.font="16px Arial",this.ctx.fillText("SoL - Speed of Light RTS",20,30),this.ctx.fillText(`Game Time: ${t.gameTime.toFixed(1)}s`,20,50);let i=80;for(const e of t.players){const t=this.getFactionColor(e.faction);if(this.ctx.fillStyle=t,this.ctx.fillText(`${e.name} (${e.faction})`,20,i),this.ctx.fillStyle="#FFFFFF",this.ctx.fillText(`Solarium: ${e.solarium.toFixed(1)}`,20,i+20),e.stellarForge){const t=e.stellarForge.isReceivingLight?"✓ Light":"✗ No Light";this.ctx.fillText(`${t} | HP: ${e.stellarForge.health.toFixed(0)}`,20,i+40)}i+=60}this.ctx.fillStyle="rgba(0, 0, 0, 0.7)",this.ctx.fillRect(10,this.canvas.height-60,300,50),this.ctx.fillStyle="#FFFFFF",this.ctx.font="14px Arial",this.ctx.fillText("Controls: Touch/Click to interact",20,this.canvas.height-35),this.ctx.fillText("Scroll/Pinch to zoom",20,this.canvas.height-15)}render(t){this.ctx.fillStyle="#000011",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#FFFFFF";for(let t=0;t<100;t++){const i=137.5*t%this.canvas.width,e=217.3*t%this.canvas.height,s=t%3*.5+.5;this.ctx.fillRect(i,e,s,s)}for(const i of t.suns)this.drawSun(i);for(const i of t.players)i.isDefeated()||this.drawConnections(i,t.suns);for(const i of t.players){if(i.isDefeated())continue;const t=this.getFactionColor(i.faction);for(const e of i.solarMirrors)this.drawSolarMirror(e,t);i.stellarForge&&this.drawStellarForge(i.stellarForge,t)}this.drawUI(t);const i=t.checkVictoryConditions();i&&(this.ctx.fillStyle="rgba(0, 0, 0, 0.8)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle=this.getFactionColor(i.faction),this.ctx.font="bold 48px Arial",this.ctx.textAlign="center",this.ctx.fillText(`${i.name} WINS!`,this.canvas.width/2,this.canvas.height/2),this.ctx.textAlign="left")}setZoom(t){this.zoom=Math.max(.5,Math.min(2,t))}setCameraPosition(t){this.camera=t}}class l{constructor(){this.lastTime=0,this.isRunning=!1;const e=document.getElementById("gameCanvas");if(!e)throw new Error("Canvas element not found");this.renderer=new a(e),this.game=function(t){const e=new r;e.suns.push(new o(new i(0,0),1,100));const s=[[new i(-500,0),[new i(-450,0),new i(-400,0)]],[new i(500,0),[new i(450,0),new i(400,0)]]];for(let i=0;i<t.length&&!(i>=s.length);i++){const[n,o]=t[i],r=new h(n,o),[a,l]=s[i];e.initializePlayer(r,a,l),e.players.push(r)}return e.isRunning=!0,e}([["Player 1",t.RADIANT],["Player 2",t.AURUM]]),this.setupInputHandlers(e),this.start()}setupInputHandlers(t){let e=!1,s=0,n=0;t.addEventListener("wheel",t=>{t.preventDefault();const i=t.deltaY>0?.9:1.1;this.renderer.setZoom(this.renderer.zoom*i)});const o=(t,i)=>{e=!0,s=t,n=i},h=(t,o)=>{if(e){const e=t-s,h=o-n;s=t,n=o;const r=this.renderer.camera;this.renderer.setCameraPosition(new i(r.x-e/this.renderer.zoom,r.y-h/this.renderer.zoom))}},r=()=>{e=!1};t.addEventListener("mousedown",t=>{o(t.clientX,t.clientY)}),t.addEventListener("mousemove",t=>{h(t.clientX,t.clientY)}),t.addEventListener("mouseup",()=>{r()}),t.addEventListener("mouseleave",()=>{r()}),t.addEventListener("touchstart",t=>{1===t.touches.length&&(t.preventDefault(),o(t.touches[0].clientX,t.touches[0].clientY))},{passive:!1}),t.addEventListener("touchmove",t=>{1===t.touches.length&&(t.preventDefault(),h(t.touches[0].clientX,t.touches[0].clientY))},{passive:!1}),t.addEventListener("touchend",()=>{r()})}update(t){this.game.isRunning&&this.game.update(t)}render(){this.renderer.render(this.game)}gameLoop(t){if(!this.isRunning)return;const i=0===this.lastTime?0:(t-this.lastTime)/1e3;this.lastTime=t,this.update(Math.min(i,.1)),this.render(),requestAnimationFrame(t=>this.gameLoop(t))}start(){this.isRunning=!0,this.lastTime=0,requestAnimationFrame(t=>this.gameLoop(t))}stop(){this.isRunning=!1}}document.addEventListener("DOMContentLoaded",()=>{new l})})();